function module(t){try{return angular.module(t)}catch(e){return angular.module(t,[])}}angular.module("yatayat",["ionic","ngCordova","yatayat.factories","yatayat.controllers"]).run(["$ionicPlatform","$rootScope","Loading",function(t,e,o){t.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault(),e.$on("loading:show",function(){o.show()}),e.$on("loading:hide",function(){o.hide()})})}]).config(["$httpProvider",function(t){t.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",t.interceptors.push(["$rootScope",function(t){return{request:function(e){return t.$broadcast("loading:show"),e},response:function(e){return t.$broadcast("loading:hide"),e}}}])}]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/start"),t.state("start",{url:"/start",templateUrl:"templates/start.html",controller:"StartCtrl"}).state("app",{url:"/app","abstract":!0,templateUrl:"templates/menu.html",controller:"AppCtrl"}).state("app.posts",{url:"/posts",views:{menuContent:{templateUrl:"templates/posts.html",controller:"PostsCtrl"}}}).state("app.post",{url:"/posts/:postId",views:{menuContent:{templateUrl:"templates/post.html",controller:"PostCtrl"}}}).state("app.report",{url:"/report",views:{menuContent:{templateUrl:"templates/report.html",controller:"ReportCtrl"}}}).state("app.search",{url:"/search",views:{menuContent:{templateUrl:"templates/search.html",controller:"SearchCtrl"}}})}]),module("yatayat.controllers").controller("AppCtrl",["$scope","$rootScope","Modal","$timeout",function(t,e,o,n){t.loginData={},o.setup(t,"templates/login.html"),t.login=function(){t.showModal()},t.closeLogin=function(){t.closeModal()},t.doLogin=function(){console.log("Doing login",t.loginData),n(function(){t.closeLogin()},1e3)}}]),module("yatayat.controllers").controller("PostCtrl",["$scope","$stateParams","Post",function(t,e,o){t.post={},o.get(e.postId,function(e){t.post=e})}]),module("yatayat.controllers").controller("PostsCtrl",["$scope","Post",function(t,e){t.posts=[],e.all(function(e){t.posts=e}),t.likePost=function(t,e){e.preventDefault()},t.editPost=function(t,e){e.preventDefault()}}]),module("yatayat.controllers").controller("ReportCtrl",["$scope","$stateParams",function(){}]),module("yatayat.controllers").controller("SearchCtrl",["$scope","$stateParams",function(){}]),module("yatayat.controllers").controller("StartCtrl",["$scope","$rootScope","User","Sim","Modal","Navigator","$ionicPopup","Validator",function(t,e,o,n,r,a,i){r.setup(t,"templates/tos.html"),t.enterMain=function(t){e.userId=t,a.go("app.posts",!0)},o.checkRegistration().then(function(e){t.enterMain(e.sim_serial_number)},function(){}),t.registerWithCredentials=function(e,n){o.register(e,n).then(function(){i.alert({title:"Success",template:e+" registered successfully."}).then(function(){t.enterMain(e)})})},t.register=function(){n.getDetails().then(function(e){t.registerWithCredentials(e.simSerialNumber,e.line1Number)})}}]),module("yatayat.factories").factory("BaseModel",[function(){return{build:function(t){var e=Object.create(this);return angular.extend(e,t),e}}}]),module("yatayat.factories").factory("Loading",["$ionicLoading",function(t){return{show:function(){t.show({template:"<img src='img/spinner.gif'>"})},hide:function(){t.hide()}}}]),module("yatayat.factories").factory("Modal",["$ionicModal",function(t){return{setup:function(e,o){t.fromTemplateUrl(o,{scope:e}).then(function(t){e.modal=t}),e.closeModal=function(){e.modal.hide()},e.showModal=function(){e.modal.show()}}}}]),module("yatayat.factories").factory("Navigator",["$state","$ionicViewService",function(t,e){return{go:function(o,n){t.go(o).then(function(){n&&e.clearHistory()})}}}]),module("yatayat.factories").factory("Post",["BaseModel","Raven",function(t){var e=[{id:1,title:"Accident at Koteshwor",description:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."},{id:2,title:"Road Block at Sallaghari",description:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."}];return angular.extend(t,{all:function(o){var n=[];angular.forEach(e,function(e){n.push(t.build(e))}),o(n)},get:function(o,n){var r=e.filter(function(t){return t.id===parseInt(o)})[0];n(t.build(r))},descLength:function(){return this.description.length}})}]),module("yatayat.factories").factory("Raven",["$http","$q",function(t,e){var o="http://yatayat-sadixa.rhcloud.com/";return{get:function(n){var r=e.defer();return t({url:o+n,method:"GET"}).then(function(t){r.resolve(t.data)},function(){r.reject()}),r.promise},post:function(n,r){var a=e.defer();return t({url:o+n,method:"POST",data:$.param(r)}).then(function(){a.resolve()},function(){a.reject()}),a.promise}}}]),module("yatayat.factories").factory("Sim",["$q",function(t){return{getDetails:function(){var e=t.defer();if("undefined"!=typeof cordova){var o=cordova.require("cordova/plugin/telephonenumber");o.get(function(t){e.resolve(t)})}else e.resolve({simSerialNumber:"nanu"});return e.promise}}}]),module("yatayat.factories").factory("User",["Raven","$q","Sim",function(t,e,o){return{checkRegistration:function(){var n=e.defer();return o.getDetails().then(function(e){t.get("users/"+e.simSerialNumber).then(function(t){t.id?n.resolve(t):n.reject()},function(){n.reject()})}),n.promise},register:function(o,n){var r=e.defer(),a={};return a.sim_serial_number=o,n&&(a.phone_number=n),t.post("users",{user:a}).then(function(){r.resolve()}),r.promise}}}]),module("yatayat.factories").factory("Validator",[function(){return{isValidPhone:function(t){var e=/^\d{10}$/;return t.match(e)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluaXQuanMiLCJhcHAuanMiLCJjb250cm9sbGVycy9hcHBfY29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL3Bvc3RfY29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL3Bvc3RzX2NvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9yZXBvcnRfY29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL3NlYXJjaF9jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvc3RhcnRfY29udHJvbGxlci5qcyIsImZhY3Rvcmllcy9iYXNlX21vZGVsLmpzIiwiZmFjdG9yaWVzL2xvYWRpbmcuanMiLCJmYWN0b3JpZXMvbW9kYWwuanMiLCJmYWN0b3JpZXMvbmF2aWdhdG9yLmpzIiwiZmFjdG9yaWVzL3Bvc3QuanMiLCJmYWN0b3JpZXMvcmF2ZW4uanMiLCJmYWN0b3JpZXMvc2ltLmpzIiwiZmFjdG9yaWVzL3VzZXIuanMiLCJmYWN0b3JpZXMvdmFsaWRhdG9yLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFFBQUEsUUFBQSxHQUNBLElBQ0EsTUFBQSxTQUFBLE9BQUEsR0FDQSxNQUFBLEdBQ0EsTUFBQSxTQUFBLE9BQUEsT0NNQSxRQUFBLE9BQUEsV0FBQSxRQUFBLFlBQUEsb0JBQUEsd0JBRUEsS0FBQSxpQkFBQSxhQUFBLFVBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLE1BQUEsV0FHQSxPQUFBLFNBQUEsT0FBQSxRQUFBLFFBQUEsVUFDQSxRQUFBLFFBQUEsU0FBQSwwQkFBQSxHQUdBLE9BQUEsV0FFQSxVQUFBLGVBR0EsRUFBQSxJQUFBLGVBQUEsV0FDQSxFQUFBLFNBR0EsRUFBQSxJQUFBLGVBQUEsV0FDQSxFQUFBLGNBSUEsUUFBQSxnQkFBQSxTQUFBLEdBRUEsRUFBQSxTQUFBLFFBQUEsS0FBQSxnQkFBQSxvQ0FRQSxFQUFBLGFBQUEsTUFBQSxhQUFBLFNBQUEsR0FDQSxPQUNBLFFBQUEsU0FBQSxHQUVBLE1BREEsR0FBQSxXQUFBLGdCQUNBLEdBRUEsU0FBQSxTQUFBLEdBRUEsTUFEQSxHQUFBLFdBQUEsZ0JBQ0EsVUFNQSxRQUFBLGlCQUFBLHFCQUFBLFNBQUEsRUFBQSxHQUVBLEVBQUEsVUFBQSxVQUVBLEVBQ0EsTUFBQSxTQUNBLElBQUEsU0FDQSxZQUFBLHVCQUNBLFdBQUEsY0FHQSxNQUFBLE9BQ0EsSUFBQSxPQUNBLFlBQUEsRUFDQSxZQUFBLHNCQUNBLFdBQUEsWUFHQSxNQUFBLGFBQ0EsSUFBQSxTQUNBLE9BQ0EsYUFDQSxZQUFBLHVCQUNBLFdBQUEsZ0JBS0EsTUFBQSxZQUNBLElBQUEsaUJBQ0EsT0FDQSxhQUNBLFlBQUEsc0JBQ0EsV0FBQSxlQUtBLE1BQUEsY0FDQSxJQUFBLFVBQ0EsT0FDQSxhQUNBLFlBQUEsd0JBQ0EsV0FBQSxpQkFLQSxNQUFBLGNBQ0EsSUFBQSxVQUNBLE9BQ0EsYUFDQSxZQUFBLHdCQUNBLFdBQUEsb0JDL0dBLE9BQUEsdUJBRUEsV0FBQSxXQUFBLFNBQUEsYUFBQSxRQUFBLFdBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUVBLEVBQUEsYUFFQSxFQUFBLE1BQUEsRUFBQSx3QkFFQSxFQUFBLE1BQUEsV0FDQSxFQUFBLGFBSUEsRUFBQSxXQUFBLFdBQ0EsRUFBQSxjQUlBLEVBQUEsUUFBQSxXQUNBLFFBQUEsSUFBQSxjQUFBLEVBQUEsV0FJQSxFQUFBLFdBQ0EsRUFBQSxjQUNBLFNDekJBLE9BQUEsdUJBRUEsV0FBQSxZQUFBLFNBQUEsZUFBQSxPQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxRQUVBLEVBQUEsSUFBQSxFQUFBLE9BQUEsU0FBQSxHQUNBLEVBQUEsS0FBQSxPQ05BLE9BQUEsdUJBRUEsV0FBQSxhQUFBLFNBQUEsT0FBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLFNBRUEsRUFBQSxJQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsSUFHQSxFQUFBLFNBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxrQkFHQSxFQUFBLFNBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxxQkNkQSxPQUFBLHVCQUVBLFdBQUEsY0FBQSxTQUFBLGVBQUEsZUNGQSxPQUFBLHVCQUVBLFdBQUEsY0FBQSxTQUFBLGVBQUEsZUNGQSxPQUFBLHVCQUVBLFdBQUEsYUFDQSxTQUFBLGFBQUEsT0FBQSxNQUFBLFFBQUEsWUFBQSxjQUFBLFlBQ0EsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUVBLEVBQUEsTUFBQSxFQUFBLHNCQUVBLEVBQUEsVUFBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLEVBQ0EsRUFBQSxHQUFBLGFBQUEsSUFHQSxFQUFBLG9CQUNBLEtBQUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxFQUFBLG9CQUNBLGNBR0EsRUFBQSx3QkFBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLFNBQUEsRUFBQSxHQUNBLEtBQUEsV0FDQSxFQUFBLE9BQ0EsTUFBQSxVQUNBLFNBQUEsRUFBQSw4QkFDQSxLQUFBLFdBQ0EsRUFBQSxVQUFBLFFBS0EsRUFBQSxTQUFBLFdBQ0EsRUFBQSxhQUNBLEtBQUEsU0FBQSxHQUNBLEVBQUEsd0JBQUEsRUFBQSxnQkFBQSxFQUFBLG1CQ2xDQSxPQUFBLHFCQUVBLFFBQUEsYUFBQSxXQUNBLE9BRUEsTUFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLE9BQUEsT0FBQSxLQUVBLE9BREEsU0FBQSxPQUFBLEVBQUEsR0FDQSxPQ1JBLE9BQUEscUJBRUEsUUFBQSxXQUFBLGdCQUFBLFNBQUEsR0FDQSxPQUNBLEtBQUEsV0FDQSxFQUFBLE1BQUEsU0FBQSxpQ0FHQSxLQUFBLFdBQ0EsRUFBQSxZQ1RBLE9BQUEscUJBRUEsUUFBQSxTQUFBLGNBQUEsU0FBQSxHQUNBLE9BT0EsTUFBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLGdCQUFBLEdBQ0EsTUFBQSxJQUNBLEtBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxJQUdBLEVBQUEsV0FBQSxXQUNBLEVBQUEsTUFBQSxRQUdBLEVBQUEsVUFBQSxXQUNBLEVBQUEsTUFBQSxhQ3RCQSxPQUFBLHFCQUVBLFFBQUEsYUFBQSxTQUFBLG9CQUFBLFNBQUEsRUFBQSxHQUNBLE9BQ0EsR0FBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLEdBQUEsR0FBQSxLQUFBLFdBQ0EsR0FBQSxFQUFBLHNCQ05BLE9BQUEscUJBRUEsUUFBQSxRQUFBLFlBQUEsUUFBQSxTQUFBLEdBQ0EsR0FBQSxLQUNBLEdBQUEsRUFBQSxNQUFBLHdCQUFBLFlBQUEsbWNBQ0EsR0FBQSxFQUFBLE1BQUEsMkJBQUEsWUFBQSxrY0FHQSxPQUFBLFNBQUEsT0FBQSxHQUNBLElBQUEsU0FBQSxHQUNBLEdBQUEsS0FDQSxTQUFBLFFBQUEsRUFBQSxTQUFBLEdBQ0EsRUFBQSxLQUFBLEVBQUEsTUFBQSxNQUVBLEVBQUEsSUFHQSxJQUFBLFNBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLE9BQUEsU0FBQSxHQUFBLE1BQUEsR0FBQSxLQUFBLFNBQUEsS0FBQSxFQUNBLEdBQUEsRUFBQSxNQUFBLEtBR0EsV0FBQSxXQUNBLE1BQUEsTUFBQSxZQUFBLGFDdkJBLE9BQUEscUJBRUEsUUFBQSxTQUFBLFFBQUEsS0FBQSxTQUFBLEVBQUEsR0FFQSxHQUFBLEdBQUEsb0NBQ0EsUUFDQSxJQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxPQVdBLE9BVEEsSUFDQSxJQUFBLEVBQUEsRUFDQSxPQUFBLFFBQ0EsS0FBQSxTQUFBLEdBQ0EsRUFBQSxRQUFBLEVBQUEsT0FDQSxXQUNBLEVBQUEsV0FHQSxFQUFBLFNBR0EsS0FBQSxTQUFBLEVBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxPQVlBLE9BVkEsSUFDQSxJQUFBLEVBQUEsRUFDQSxPQUFBLE9BQ0EsS0FBQSxFQUFBLE1BQUEsS0FDQSxLQUFBLFdBQ0EsRUFBQSxXQUNBLFdBQ0EsRUFBQSxXQUdBLEVBQUEsYUNsQ0EsT0FBQSxxQkFFQSxRQUFBLE9BQUEsS0FBQSxTQUFBLEdBQ0EsT0FDQSxXQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsT0FDQSxJQUFBLG1CQUFBLFNBQUEsQ0FDQSxHQUFBLEdBQUEsUUFBQSxRQUFBLGlDQUNBLEdBQUEsSUFBQSxTQUFBLEdBQ0EsRUFBQSxRQUFBLFNBR0EsR0FBQSxTQUFBLGdCQUFBLFFBRUEsT0FBQSxHQUFBLGFDZEEsT0FBQSxxQkFFQSxRQUFBLFFBQUEsUUFBQSxLQUFBLE1BQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxPQUNBLGtCQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsT0FjQSxPQWJBLEdBQUEsYUFDQSxLQUFBLFNBQUEsR0FDQSxFQUFBLElBQUEsU0FBQSxFQUFBLGlCQUNBLEtBQUEsU0FBQSxHQUNBLEVBQUEsR0FDQSxFQUFBLFFBQUEsR0FFQSxFQUFBLFVBRUEsV0FDQSxFQUFBLGFBR0EsRUFBQSxTQUdBLFNBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsUUFFQSxJQVlBLE9BWEEsR0FBQSxrQkFBQSxFQUNBLElBQ0EsRUFBQSxhQUFBLEdBR0EsRUFBQSxLQUFBLFNBQ0EsS0FBQSxJQUVBLEtBQUEsV0FDQSxFQUFBLFlBRUEsRUFBQSxhQ3JDQSxPQUFBLHFCQUVBLFFBQUEsYUFBQSxXQUNBLE9BQ0EsYUFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLFVBQ0EsT0FBQSxHQUFBLE1BQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbW9kdWxlKG5hbWUpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYW5ndWxhci5tb2R1bGUobmFtZSlcbiAgfSBjYXRjaChlcnIpIHtcbiAgICByZXR1cm4gYW5ndWxhci5tb2R1bGUobmFtZSwgW10pXG4gIH1cbn1cblxuIiwiLy8gWWF0YXlhdFxuLyoqXG4gKiBAYXV0aG9yOiBrb2lyYWxhLnNhZGl4YUBnbWFpbC5jb21cbiAqIEB0ZWFtOiB5YXRheWF0XG4gKiBDb3B5cmlnaHQgMjAxNCwgQHNhZGl4YW5hbnVcbiAqKi9cbi8vIGFuZ3VsYXIubW9kdWxlIGlzIGEgZ2xvYmFsIHBsYWNlIGZvciBjcmVhdGluZywgcmVnaXN0ZXJpbmcgYW5kIHJldHJpZXZpbmcgQW5ndWxhciBtb2R1bGVzXG4vLyAneWF0YXlhdCcgaXMgdGhlIG5hbWUgb2YgdGhpcyBhbmd1bGFyIG1vZHVsZSBleGFtcGxlIChhbHNvIHNldCBpbiBhIDxib2R5PiBhdHRyaWJ1dGUgaW4gaW5kZXguaHRtbClcbi8vIHRoZSAybmQgcGFyYW1ldGVyIGlzIGFuIGFycmF5IG9mICdyZXF1aXJlcydcbi8vICd5YXRheWF0LmNvbnRyb2xsZXJzJyBpcyBmb3VuZCBpbiBjb250cm9sbGVycy5qc1xuYW5ndWxhci5tb2R1bGUoJ3lhdGF5YXQnLCBbJ2lvbmljJywgJ25nQ29yZG92YScsICd5YXRheWF0LmZhY3RvcmllcycsICd5YXRheWF0LmNvbnRyb2xsZXJzJ10pXG5cbi5ydW4oWyckaW9uaWNQbGF0Zm9ybScsICckcm9vdFNjb3BlJywgJ0xvYWRpbmcnLCAgZnVuY3Rpb24oJGlvbmljUGxhdGZvcm0sICAkcm9vdFNjb3BlLCBMb2FkaW5nKSB7XG4gICRpb25pY1BsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIC8vIEhpZGUgdGhlIGFjY2Vzc29yeSBiYXIgYnkgZGVmYXVsdCAocmVtb3ZlIHRoaXMgdG8gc2hvdyB0aGUgYWNjZXNzb3J5IGJhciBhYm92ZSB0aGUga2V5Ym9hcmRcbiAgICAvLyBmb3IgZm9ybSBpbnB1dHMpXG4gICAgaWYod2luZG93LmNvcmRvdmEgJiYgd2luZG93LmNvcmRvdmEucGx1Z2lucy5LZXlib2FyZCkge1xuICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmhpZGVLZXlib2FyZEFjY2Vzc29yeUJhcih0cnVlKTtcbiAgICB9XG5cbiAgICBpZih3aW5kb3cuU3RhdHVzQmFyKSB7XG4gICAgICAvLyBvcmcuYXBhY2hlLmNvcmRvdmEuc3RhdHVzYmFyIHJlcXVpcmVkXG4gICAgICBTdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgJHJvb3RTY29wZS4kb24oJ2xvYWRpbmc6c2hvdycsIGZ1bmN0aW9uKCkge1xuICAgICAgTG9hZGluZy5zaG93KCk7XG4gICAgfSlcblxuICAgICRyb290U2NvcGUuJG9uKCdsb2FkaW5nOmhpZGUnLCBmdW5jdGlvbigpIHtcbiAgICAgIExvYWRpbmcuaGlkZSgpO1xuICAgIH0pXG4gIH0pO1xufV0pXG4uY29uZmlnKFsnJGh0dHBQcm92aWRlcicsIGZ1bmN0aW9uICgkaHR0cFByb3ZpZGVyKSB7XG4gIC8vIGZpeCBmb3IgJGh0dHAucG9zdCBub3Qgc2VuZGluZyBkYXRhXG4gICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5wb3N0WydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnO1xuXG4gIC8vIFJlc2V0IGhlYWRlcnMgdG8gYXZvaWQgT1BUSU9OUyByZXF1ZXN0IChha2EgcHJlZmxpZ2h0KVxuICAvLyAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uID0ge307XG4gIC8vICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5wb3N0ID0ge307XG4gIC8vICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5wdXQgPSB7fTtcbiAgLy8gJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLnBhdGNoID0ge307XG4gIC8vIFVuaWZpZWQgbG9hZGluZyB3aGVuIGh0dHAgcmVxdWVzdCBtYWRlXG4gICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goZnVuY3Rpb24oJHJvb3RTY29wZSkge1xuICAgcmV0dXJuIHtcbiAgICAgcmVxdWVzdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkaW5nOnNob3cnKTtcbiAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICB9LFxuICAgICByZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRpbmc6aGlkZScpO1xuICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgfVxuICAgfVxuICB9KTtcbn1dKVxuXG4uY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAvLyBpZiBub25lIG9mIHRoZSBhYm92ZSBzdGF0ZXMgYXJlIG1hdGNoZWQsIHVzZSB0aGlzIGFzIHRoZSBmYWxsYmFja1xuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvc3RhcnQnKTtcblxuICAkc3RhdGVQcm92aWRlclxuICAgIC5zdGF0ZSgnc3RhcnQnLCB7XG4gICAgICB1cmw6ICcvc3RhcnQnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvc3RhcnQuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAnU3RhcnRDdHJsJ1xuICAgIH0pXG5cbiAgICAuc3RhdGUoJ2FwcCcsIHtcbiAgICAgIHVybDogJy9hcHAnLFxuICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9tZW51Lmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ0FwcEN0cmwnXG4gICAgfSlcblxuICAgIC5zdGF0ZSgnYXBwLnBvc3RzJywge1xuICAgICAgdXJsOiAnL3Bvc3RzJyxcbiAgICAgIHZpZXdzOiB7XG4gICAgICAgICdtZW51Q29udGVudCcgOntcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9wb3N0cy5odG1sJyxcbiAgICAgICAgICBjb250cm9sbGVyOiAnUG9zdHNDdHJsJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIC5zdGF0ZSgnYXBwLnBvc3QnLCB7XG4gICAgICB1cmw6ICcvcG9zdHMvOnBvc3RJZCcsXG4gICAgICB2aWV3czoge1xuICAgICAgICAnbWVudUNvbnRlbnQnIDp7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvcG9zdC5odG1sJyxcbiAgICAgICAgICBjb250cm9sbGVyOiAnUG9zdEN0cmwnXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLnN0YXRlKCdhcHAucmVwb3J0Jywge1xuICAgICAgdXJsOiAnL3JlcG9ydCcsXG4gICAgICB2aWV3czoge1xuICAgICAgICAnbWVudUNvbnRlbnQnIDp7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvcmVwb3J0Lmh0bWwnLFxuICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZXBvcnRDdHJsJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIC5zdGF0ZSgnYXBwLnNlYXJjaCcsIHtcbiAgICAgIHVybDogJy9zZWFyY2gnLFxuICAgICAgdmlld3M6IHtcbiAgICAgICAgJ21lbnVDb250ZW50JyA6e1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3NlYXJjaC5odG1sJyxcbiAgICAgICAgICBjb250cm9sbGVyOiAnU2VhcmNoQ3RybCdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbn1dKVxuIiwibW9kdWxlKCd5YXRheWF0LmNvbnRyb2xsZXJzJylcblxuLmNvbnRyb2xsZXIoJ0FwcEN0cmwnLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ01vZGFsJywgJyR0aW1lb3V0JywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBNb2RhbCwgJHRpbWVvdXQpIHtcbiAgLy8gRm9ybSBkYXRhIGZvciB0aGUgbG9naW4gbW9kYWxcbiAgJHNjb3BlLmxvZ2luRGF0YSA9IHt9O1xuXG4gIE1vZGFsLnNldHVwKCRzY29wZSwgJ3RlbXBsYXRlcy9sb2dpbi5odG1sJyk7XG5cbiAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oKSB7XG4gICAgJHNjb3BlLnNob3dNb2RhbCgpO1xuICB9XG5cbiAgLy8gVHJpZ2dlcmVkIGluIHRoZSBsb2dpbiBtb2RhbCB0byBjbG9zZSBpdFxuICAkc2NvcGUuY2xvc2VMb2dpbiA9IGZ1bmN0aW9uKCkge1xuICAgICRzY29wZS5jbG9zZU1vZGFsKCk7XG4gIH07XG5cbiAgLy8gUGVyZm9ybSB0aGUgbG9naW4gYWN0aW9uIHdoZW4gdGhlIHVzZXIgc3VibWl0cyB0aGUgbG9naW4gZm9ybVxuICAkc2NvcGUuZG9Mb2dpbiA9IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUubG9nKCdEb2luZyBsb2dpbicsICRzY29wZS5sb2dpbkRhdGEpO1xuXG4gICAgLy8gU2ltdWxhdGUgYSBsb2dpbiBkZWxheS4gUmVtb3ZlIHRoaXMgYW5kIHJlcGxhY2Ugd2l0aCB5b3VyIGxvZ2luXG4gICAgLy8gY29kZSBpZiB1c2luZyBhIGxvZ2luIHN5c3RlbVxuICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgJHNjb3BlLmNsb3NlTG9naW4oKTtcbiAgICB9LCAxMDAwKTtcbiAgfTtcbn1dKVxuXG4iLCJtb2R1bGUoJ3lhdGF5YXQuY29udHJvbGxlcnMnKVxuXG4uY29udHJvbGxlcignUG9zdEN0cmwnLCBbJyRzY29wZScsICckc3RhdGVQYXJhbXMnLCAnUG9zdCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlUGFyYW1zLCBQb3N0KSB7XG4gICRzY29wZS5wb3N0ID0ge307XG5cbiAgUG9zdC5nZXQoJHN0YXRlUGFyYW1zLnBvc3RJZCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICRzY29wZS5wb3N0ID0gZGF0YTtcbiAgfSk7XG59XSlcblxuIiwibW9kdWxlKCd5YXRheWF0LmNvbnRyb2xsZXJzJylcblxuLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIFsnJHNjb3BlJywgJ1Bvc3QnLCBmdW5jdGlvbigkc2NvcGUsIFBvc3QpIHtcbiAgJHNjb3BlLnBvc3RzID0gW107XG5cbiAgUG9zdC5hbGwoZnVuY3Rpb24oZGF0YSkge1xuICAgICRzY29wZS5wb3N0cyA9IGRhdGE7XG4gIH0pO1xuXG4gICRzY29wZS5saWtlUG9zdCA9IGZ1bmN0aW9uKCRpbmRleCwgJGV2ZW50KSB7XG4gICAgJGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH07XG5cbiAgJHNjb3BlLmVkaXRQb3N0ID0gZnVuY3Rpb24oJGluZGV4LCAkZXZlbnQpIHtcbiAgICAkZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfTtcbn1dKVxuXG4iLCJtb2R1bGUoJ3lhdGF5YXQuY29udHJvbGxlcnMnKVxuXG4uY29udHJvbGxlcignUmVwb3J0Q3RybCcsIFsnJHNjb3BlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlUGFyYW1zKSB7XG59XSlcblxuIiwibW9kdWxlKCd5YXRheWF0LmNvbnRyb2xsZXJzJylcblxuLmNvbnRyb2xsZXIoJ1NlYXJjaEN0cmwnLCBbJyRzY29wZScsICckc3RhdGVQYXJhbXMnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZVBhcmFtcykge1xufV0pXG5cbiIsIm1vZHVsZSgneWF0YXlhdC5jb250cm9sbGVycycpXG5cbi5jb250cm9sbGVyKCdTdGFydEN0cmwnLFxuICBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ1VzZXInLCAnU2ltJywgJ01vZGFsJywgJ05hdmlnYXRvcicsICckaW9uaWNQb3B1cCcsICdWYWxpZGF0b3InLFxuICBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIFVzZXIsIFNpbSwgTW9kYWwsIE5hdmlnYXRvciwgJGlvbmljUG9wdXAsIFZhbGlkYXRvcikge1xuXG4gIE1vZGFsLnNldHVwKCRzY29wZSwgJ3RlbXBsYXRlcy90b3MuaHRtbCcpO1xuXG4gICRzY29wZS5lbnRlck1haW4gPSBmdW5jdGlvbihzaW1TZXJpYWxOdW1iZXIpIHtcbiAgICAkcm9vdFNjb3BlLnVzZXJJZCA9IHNpbVNlcmlhbE51bWJlcjtcbiAgICBOYXZpZ2F0b3IuZ28oJ2FwcC5wb3N0cycsIHRydWUpO1xuICB9O1xuXG4gIFVzZXIuY2hlY2tSZWdpc3RyYXRpb24oKVxuICAudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgJHNjb3BlLmVudGVyTWFpbih1c2VyLnNpbV9zZXJpYWxfbnVtYmVyKTtcbiAgfSwgZnVuY3Rpb24oKSB7XG4gIH0pO1xuXG4gICRzY29wZS5yZWdpc3RlcldpdGhDcmVkZW50aWFscyA9IGZ1bmN0aW9uKHNpbVNlcmlhbE51bWJlciwgcGhvbmVOdW1iZXIpIHtcbiAgICBVc2VyLnJlZ2lzdGVyKHNpbVNlcmlhbE51bWJlciwgcGhvbmVOdW1iZXIpXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgIHRpdGxlOiAnU3VjY2VzcycsXG4gICAgICAgIHRlbXBsYXRlOiBzaW1TZXJpYWxOdW1iZXIgKyAnIHJlZ2lzdGVyZWQgc3VjY2Vzc2Z1bGx5LidcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS5lbnRlck1haW4oc2ltU2VyaWFsTnVtYmVyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uKCkge1xuICAgIFNpbS5nZXREZXRhaWxzKClcbiAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICRzY29wZS5yZWdpc3RlcldpdGhDcmVkZW50aWFscyhyZXN1bHQuc2ltU2VyaWFsTnVtYmVyLCByZXN1bHQubGluZTFOdW1iZXIpO1xuICAgIH0pO1xuICB9O1xufV0pXG5cbiIsIm1vZHVsZSgneWF0YXlhdC5mYWN0b3JpZXMnKVxuXG4uZmFjdG9yeSgnQmFzZU1vZGVsJywgW2Z1bmN0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIC8vIGV4dGVuZCBhbmd1bGFyIGZhY3Rvcnkgb2JqZWN0KG1vZGVsKSB3aXRoIGFueSAnbW9kZWwgbGlrZScgb2JqZWN0KGRhdGEpXG4gICAgYnVpbGQ6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBtb2RlbCA9IE9iamVjdC5jcmVhdGUodGhpcyk7XG4gICAgICBhbmd1bGFyLmV4dGVuZChtb2RlbCwgZGF0YSk7XG4gICAgICByZXR1cm4gbW9kZWw7XG4gICAgfVxuICB9XG59XSlcblxuIiwibW9kdWxlKCd5YXRheWF0LmZhY3RvcmllcycpXG5cbi5mYWN0b3J5KCdMb2FkaW5nJywgWyckaW9uaWNMb2FkaW5nJywgZnVuY3Rpb24oJGlvbmljTG9hZGluZykge1xuICByZXR1cm4ge1xuICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgJGlvbmljTG9hZGluZy5zaG93KHt0ZW1wbGF0ZTogXCI8aW1nIHNyYz0naW1nL3NwaW5uZXIuZ2lmJz5cIn0pO1xuICAgIH0sXG5cbiAgICBoaWRlOiBmdW5jdGlvbigpIHtcbiAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgIH1cbiAgfVxufV0pXG5cbiIsIm1vZHVsZSgneWF0YXlhdC5mYWN0b3JpZXMnKVxuXG4uZmFjdG9yeSgnTW9kYWwnLCBbJyRpb25pY01vZGFsJywgZnVuY3Rpb24oJGlvbmljTW9kYWwpIHtcbiAgcmV0dXJuIHtcbiAgICAvKipcbiAgICAgKiBTZXR1cCBhIG1vZGFsIGZvciBhbnkgY29udHJvbGxlclxuICAgICAqIEBwYXJhbXM6XG4gICAgICogJHNjb3BlIFtPYmplY3RdIHRoZSBjb250cm9sbGVyJ3Mgc2NvcGUgb2JqZWN0XG4gICAgICogdGVtcGxhdGVVcmwgW1N0cmluZ10gdGhlIHBhdGggdG8gdGhlIG1vZGFsIHRlbXBsYXRlXG4gICAgICoqL1xuICAgIHNldHVwOiBmdW5jdGlvbigkc2NvcGUsIHRlbXBsYXRlVXJsKSB7XG4gICAgICAkaW9uaWNNb2RhbC5mcm9tVGVtcGxhdGVVcmwodGVtcGxhdGVVcmwsIHtcbiAgICAgICAgc2NvcGU6ICRzY29wZVxuICAgICAgfSkudGhlbihmdW5jdGlvbihtb2RhbCkge1xuICAgICAgICAkc2NvcGUubW9kYWwgPSBtb2RhbDtcbiAgICAgIH0pO1xuXG4gICAgICAkc2NvcGUuY2xvc2VNb2RhbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUubW9kYWwuaGlkZSgpO1xuICAgICAgfTtcblxuICAgICAgJHNjb3BlLnNob3dNb2RhbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUubW9kYWwuc2hvdygpO1xuICAgICAgfTtcbiAgICB9XG4gIH1cbn1dKVxuXG4iLCJtb2R1bGUoJ3lhdGF5YXQuZmFjdG9yaWVzJylcblxuLmZhY3RvcnkoJ05hdmlnYXRvcicsIFsnJHN0YXRlJywgJyRpb25pY1ZpZXdTZXJ2aWNlJywgZnVuY3Rpb24oJHN0YXRlLCAkaW9uaWNWaWV3U2VydmljZSkge1xuICByZXR1cm4ge1xuICAgIGdvOiBmdW5jdGlvbihzdGF0ZSwgY2xlYXJIaXN0b3J5KSB7XG4gICAgICAkc3RhdGUuZ28oc3RhdGUpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGNsZWFySGlzdG9yeSAmJiAkaW9uaWNWaWV3U2VydmljZS5jbGVhckhpc3RvcnkoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufV0pXG5cbiIsIm1vZHVsZSgneWF0YXlhdC5mYWN0b3JpZXMnKVxuXG4uZmFjdG9yeSgnUG9zdCcsIFsnQmFzZU1vZGVsJywgJ1JhdmVuJywgZnVuY3Rpb24oQmFzZU1vZGVsLCBSYXZlbikge1xuICB2YXIgcG9zdHMgPSBbXG4gICAgeyBpZDogMSwgdGl0bGU6ICdBY2NpZGVudCBhdCBLb3Rlc2h3b3InLCBkZXNjcmlwdGlvbjogJ0xvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNpY2luZyBlbGl0LCBzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCB1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YS4gVXQgZW5pbSBhZCBtaW5pbSB2ZW5pYW0sIHF1aXMgbm9zdHJ1ZCBleGVyY2l0YXRpb24gdWxsYW1jbyBsYWJvcmlzIG5pc2kgdXQgYWxpcXVpcCBleCBlYSBjb21tb2RvIGNvbnNlcXVhdC4gRHVpcyBhdXRlIGlydXJlIGRvbG9yIGluIHJlcHJlaGVuZGVyaXQgaW4gdm9sdXB0YXRlIHZlbGl0IGVzc2UgY2lsbHVtIGRvbG9yZSBldSBmdWdpYXQgbnVsbGEgcGFyaWF0dXIuIEV4Y2VwdGV1ciBzaW50IG9jY2FlY2F0IGN1cGlkYXRhdCBub24gcHJvaWRlbnQsIHN1bnQgaW4gY3VscGEgcXVpIG9mZmljaWEgZGVzZXJ1bnQgbW9sbGl0IGFuaW0gaWQgZXN0IGxhYm9ydW0uJ30sXG4gICAgeyBpZDogMiwgdGl0bGU6ICdSb2FkIEJsb2NrIGF0IFNhbGxhZ2hhcmknLCBkZXNjcmlwdGlvbjogJ0xvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNpY2luZyBlbGl0LCBzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCB1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YS4gVXQgZW5pbSBhZCBtaW5pbSB2ZW5pYW0sIHF1aXMgbm9zdHJ1ZCBleGVyY2l0YXRpb24gdWxsYW1jbyBsYWJvcmlzIG5pc2kgdXQgYWxpcXVpcCBleCBlYSBjb21tb2RvIGNvbnNlcXVhdC4gRHVpcyBhdXRlIGlydXJlIGRvbG9yIGluIHJlcHJlaGVuZGVyaXQgaW4gdm9sdXB0YXRlIHZlbGl0IGVzc2UgY2lsbHVtIGRvbG9yZSBldSBmdWdpYXQgbnVsbGEgcGFyaWF0dXIuIEV4Y2VwdGV1ciBzaW50IG9jY2FlY2F0IGN1cGlkYXRhdCBub24gcHJvaWRlbnQsIHN1bnQgaW4gY3VscGEgcXVpIG9mZmljaWEgZGVzZXJ1bnQgbW9sbGl0IGFuaW0gaWQgZXN0IGxhYm9ydW0uJ30sXG4gIF07XG5cbiAgcmV0dXJuIGFuZ3VsYXIuZXh0ZW5kKEJhc2VNb2RlbCwge1xuICAgIGFsbDogZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgIHZhciBkYXRhID0gW107XG4gICAgICBhbmd1bGFyLmZvckVhY2gocG9zdHMsIGZ1bmN0aW9uKHBvc3QpIHtcbiAgICAgICAgZGF0YS5wdXNoKEJhc2VNb2RlbC5idWlsZChwb3N0KSk7XG4gICAgICB9KTtcbiAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgIH0sXG5cbiAgICBnZXQ6IGZ1bmN0aW9uKGlkLCBjYWxsYmFjaykge1xuICAgICAgdmFyIGRhdGEgPSBwb3N0cy5maWx0ZXIoZnVuY3Rpb24obSkgeyByZXR1cm4gbS5pZCA9PT0gcGFyc2VJbnQoaWQpIH0pWzBdO1xuICAgICAgY2FsbGJhY2soQmFzZU1vZGVsLmJ1aWxkKGRhdGEpKTtcbiAgICB9LFxuXG4gICAgZGVzY0xlbmd0aDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5kZXNjcmlwdGlvbi5sZW5ndGg7XG4gICAgfVxuICB9KTsgLy8gZW5kIGFuZ3VsYXIuZXh0ZW5kLi5cbn1dKVxuXG4iLCJtb2R1bGUoJ3lhdGF5YXQuZmFjdG9yaWVzJylcblxuLmZhY3RvcnkoJ1JhdmVuJywgWyckaHR0cCcsICckcScsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuICAvLyB2YXIgYmFzZVVybCA9ICdodHRwOi8vMTkyLjE2OC4xLjI6MzAwMC8nO1xuICB2YXIgYmFzZVVybCA9ICdodHRwOi8veWF0YXlhdC1zYWRpeGEucmhjbG91ZC5jb20vJztcbiAgcmV0dXJuIHtcbiAgICBnZXQ6IGZ1bmN0aW9uKHBhdGgpIHtcbiAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICRodHRwKHtcbiAgICAgICAgdXJsOiBiYXNlVXJsICsgcGF0aCxcbiAgICAgICAgbWV0aG9kOiAnR0VUJ1xuICAgICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgZGVmZXIucmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgZGVmZXIucmVqZWN0KCk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XG4gICAgfSxcblxuICAgIHBvc3Q6IGZ1bmN0aW9uKHBhdGgsIGRhdGEpIHtcbiAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICRodHRwKHtcbiAgICAgICAgdXJsOiBiYXNlVXJsICsgcGF0aCxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGRhdGE6ICQucGFyYW0oZGF0YSksXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBkZWZlci5yZXNvbHZlKCk7XG4gICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgZGVmZXIucmVqZWN0KCk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XG4gICAgfVxuICB9XG59XSlcblxuIiwibW9kdWxlKCd5YXRheWF0LmZhY3RvcmllcycpXG5cbi5mYWN0b3J5KCdTaW0nLCBbJyRxJywgZnVuY3Rpb24oJHEpIHtcbiAgcmV0dXJuIHtcbiAgICBnZXREZXRhaWxzOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XG4gICAgICBpZih0eXBlb2YgY29yZG92YSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdmFyIHRlbGVwaG9uZU51bWJlciA9IGNvcmRvdmEucmVxdWlyZSgnY29yZG92YS9wbHVnaW4vdGVsZXBob25lbnVtYmVyJyk7XG4gICAgICAgIHRlbGVwaG9uZU51bWJlci5nZXQoZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgZGVmZXIucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlZmVyLnJlc29sdmUoe3NpbVNlcmlhbE51bWJlcjogJ25hbnUnfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcbiAgICB9XG4gIH1cbn1dKVxuXG4iLCJtb2R1bGUoJ3lhdGF5YXQuZmFjdG9yaWVzJylcblxuLmZhY3RvcnkoJ1VzZXInLCBbJ1JhdmVuJywgJyRxJywgJ1NpbScsIGZ1bmN0aW9uKFJhdmVuLCAkcSwgU2ltKSB7XG4gIHJldHVybiB7XG4gICAgY2hlY2tSZWdpc3RyYXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcbiAgICAgIFNpbS5nZXREZXRhaWxzKClcbiAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICBSYXZlbi5nZXQoJ3VzZXJzLycgKyByZXN1bHQuc2ltU2VyaWFsTnVtYmVyKVxuICAgICAgICAudGhlbihmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgaWYodXNlci5pZCkge1xuICAgICAgICAgICAgZGVmZXIucmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVmZXIucmVqZWN0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBkZWZlci5yZWplY3QoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xuICAgIH0sXG5cbiAgICByZWdpc3RlcjogZnVuY3Rpb24oc2ltU2VyaWFsTnVtYmVyLCBwaG9uZU51bWJlcikge1xuICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcblxuICAgICAgdmFyIHJlZ19pbmZvID0ge307XG4gICAgICByZWdfaW5mby5zaW1fc2VyaWFsX251bWJlciA9IHNpbVNlcmlhbE51bWJlcjtcbiAgICAgIGlmKHBob25lTnVtYmVyKSB7XG4gICAgICAgIHJlZ19pbmZvLnBob25lX251bWJlciA9IHBob25lTnVtYmVyO1xuICAgICAgfVxuXG4gICAgICBSYXZlbi5wb3N0KCd1c2VycycsIHtcbiAgICAgICAgdXNlcjogcmVnX2luZm9cbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgZGVmZXIucmVzb2x2ZSgpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcbiAgICB9XG4gIH1cbn1dKVxuXG4iLCJtb2R1bGUoJ3lhdGF5YXQuZmFjdG9yaWVzJylcblxuLmZhY3RvcnkoJ1ZhbGlkYXRvcicsIFtmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICBpc1ZhbGlkUGhvbmU6IGZ1bmN0aW9uKG51bWJlcikge1xuICAgICAgdmFyIHBob25lUmVnRXggPSAvXlxcZHsxMH0kLztcbiAgICAgIHJldHVybiBudW1iZXIubWF0Y2gocGhvbmVSZWdFeCk7XG4gICAgfVxuICB9XG59XSlcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9